<!doctype html>
<html lang="en">
<head>
  <!-- Preload + Load Material Symbols Rounded -->
  <link rel="preload" href="https://fonts.gstatic.com/s/materialsymbolsrounded/v143/flUhRq6tzZclQEJ-Vdg-IuiaDsNc.woff2" as="font" type="font/woff2" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,700,1,0" rel="stylesheet">

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>bndlabs CMS | Admin</title>

  <style>
    :root{
      --bg:#FAFAFB; --panel:#FFFFFF; --panel-2:#FFFFFF; --soft:#F6F7F9; --line:#EAEAEE;
      --text:#0B0B0B; --muted:rgba(11,11,11,.55);
      --accent:#FF4D00; --accent-2:#FF8C00;
      --green:#16A34A; --red:#DC2626; --shadow:0 10px 28px rgba(0,0,0,.06);
      --r:14px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--text);
      font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial; line-height:1.5}
    a{color:inherit;text-decoration:none}
    button{font-family:inherit}

    /* Layout */
    .app{display:grid;grid-template-columns:260px 1fr;min-height:100%}
    .side{background:var(--panel-2);border-right:1px solid var(--line);Padding:18px;position:sticky;top:0;height:100dvh}
    .brand{display:flex;align-items:center;gap:10px;margin-bottom:16px}
    .brand .logo {
  display:inline-flex;
  align-items:center;
  justify-content:center;
  width:auto;
  height:auto;
  border-radius:0;
  background:none;
  box-shadow:none;
}
    .brand .logo svg{width:20px;height:20px;fill:#fff}
    .brand .name{font-weight:900}
    .mutey{color:var(--muted);font-size:12px;text-transform:uppercase;letter-spacing:.12em;margin:12px 0 8px}
    .nav{display:flex;flex-direction:column;gap:6px}
    .nav a{padding:10px 12px;border-radius:10px;color:#222;display:flex;align-items:center;gap:10px;border:1px solid transparent;transition:.18s}
    .nav a:hover{background:#FFF7F2;border-color:#FFE3D4}
    .nav a.active{background:linear-gradient(120deg,var(--accent),var(--accent-2));color:#fff;font-weight:800;box-shadow:0 8px 20px rgba(255,77,0,.25)}
    .nav a svg{width:16px;height:16px;fill:currentColor;opacity:.9}

    .main{padding:22px;display:grid;gap:18px}
    .topbar{display:flex;align-items:center;justify-content:space-between;background:var(--panel);border:1px solid var(--line);border-radius:12px;padding:12px 14px;box-shadow:var(--shadow)}
    .btn,.ghost{border:0;border-radius:10px;padding:10px 14px;cursor:pointer;font-weight:800}
    .btn{background:linear-gradient(120deg,var(--accent),var(--accent-2));color:#fff;box-shadow:0 10px 28px rgba(255,77,0,.25)}
    .ghost{background:#fff;color:#111;border:1px solid var(--line)}
    .card{background:var(--panel);border:1px solid var(--line);border-radius:var(--r);box-shadow:var(--shadow)}
    .pad{padding:18px}

    /* Tables */
    .toolbar{display:flex;gap:8px;align-items:center;justify-content:space-between;margin-bottom:10px}
    .search,.select{padding:10px 12px;border-radius:10px;border:1px solid var(--line);background:#fff}
    table{width:100%;border-collapse:collapse;font-size:14px}
    thead th{color:#444;text-align:left;padding:12px;background:#FCFCFD;border-bottom:1px solid var(--line)}
    tbody td{padding:12px;border-bottom:1px solid var(--line);color:#222;vertical-align:top}
    tbody tr:hover{background:var(--soft)}
    .tag{display:inline-block;padding:6px 10px;border-radius:999px;background:#FFF1E6;color:#A24300;font-weight:700;font-size:12px;border:1px solid #FFD9C2}
    .status{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;background:#EEF2FF;border:1px solid #DDE3FF;color:#334155;font-weight:700;font-size:12px}
    .status[data-s="hidden"]{background:#FEF3C7;border-color:#FDE68A;color:#92400E}
    .status[data-s="draft"]{background:#E5E7EB;border-color:#D1D5DB;color:#374151}
    .tools{display:flex;gap:8px;flex-wrap:wrap}
    .tiny{font-size:12px;padding:8px 10px}

    /* Forms */
    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media(max-width:1000px){.app{grid-template-columns:1fr}.side{position:relative;height:auto}.grid2{grid-template-columns:1fr}}
    label{font-size:12px;color:var(--muted);font-weight:800;text-transform:uppercase;letter-spacing:.08em}
    .field{width:100%;padding:12px 14px;border-radius:10px;background:#fff;border:1px solid var(--line);color:#111;outline:none}
    .field:focus{border-color:#FFD3BE;box-shadow:0 0 0 4px rgba(255,141,79,.12)}
    textarea.field{min-height:120px;resize:vertical}
    .row{display:grid;gap:6px}
    .bar{display:flex;gap:10px;align-items:center;flex-wrap:wrap}

    /* Sections + Rich Editor */
    .sections{display:flex;flex-direction:column;gap:12px}
    .section{border:1px dashed var(--line);background:#FFFDFB;border-radius:12px;padding:12px}
    .s-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
    .s-title{font-weight:900;color:#222}
    .s-tools{display:flex;gap:6px}
    .iconbtn{border:1px solid var(--line);background:#fff;color:#111;border-radius:8px;padding:6px 8px;cursor:pointer}
    .iconbtn:hover{background:#FFF6F0;border-color:#FFD9C2}

    /* RTE */
    .rte{display:flex;align-items:center;gap:8px;background:#fff;border:1px solid var(--line);border-radius:10px;padding:6px 8px;margin-bottom:6px}
    .rte .dropdown{position:relative}
    .rte .dd-btn{display:inline-flex;align-items:center;gap:8px;border:1px solid var(--line);background:#fff;border-radius:8px;padding:6px 10px;cursor:pointer;font-weight:700}
    .rte .dd{position:absolute;top:100%;left:0;background:#fff;border:1px solid var(--line);border-radius:10px;box-shadow:var(--shadow);padding:6px;display:none;z-index:50}
    .rte .dd button{display:block;width:100%;text-align:left;border:0;background:transparent;padding:8px 10px;border-radius:8px;cursor:pointer}
    .rte .dd button:hover{background:#FFF6F0}
    .rte .btn{border:1px solid var(--line);background:#fff;border-radius:8px;padding:6px 8px;cursor:pointer;display:inline-flex;align-items:center;justify-content:center;min-width:32px;min-height:32px}
    .rte .btn:hover{background:#FFF6F0;border-color:#FFD9C2}
    .rte .btn svg{width:16px;height:16px;display:block}
    .rich{border:1px solid var(--line);border-radius:10px;padding:12px;min-height:120px;background:#fff}
    .rich:focus{outline:2px solid rgba(255,141,79,.22)}

    .material-symbols-rounded{
      font-variation-settings: 'FILL' 1, 'wght' 700, 'GRAD' 0, 'opsz' 24;
      font-size: 20px; line-height: 1; display: inline-block; color: var(--accent);
    }

    /* Uploader */
    .uploader{border:2px dashed #E9E1DA;border-radius:12px;padding:16px;background:#FFFBF8}
    .uploader p{margin:6px 0 0;font-size:13px;color:#A24300}

    /* Gate */
    .gate{position:fixed;inset:0;background:rgba(255,255,255,.82);backdrop-filter:saturate(1.2) blur(6px);display:flex;align-items:center;justify-content:center;z-index:1000}
    .login{width:min(460px,94vw);background:#fff;border:1px solid var(--line);border-radius:16px;overflow:hidden;box-shadow:var(--shadow)}
    .login-head{background:linear-gradient(120deg,var(--accent),var(--accent-2));padding:16px;font-weight:900;text-align:center;color:#fff}
    .login-body{padding:16px}

    /* ===== ABOUT TAB POLISH (clean, consistent UI) ===== */
    .about-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media(max-width:1000px){.about-grid{grid-template-columns:1fr}}
    .about-stack{display:grid;gap:10px}
    .muted{color:var(--muted);font-size:13px}
    .hr{height:1px;background:var(--line);margin:12px 0}
    .mini{font-size:12px}
    .pill{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border:1px solid var(--line);border-radius:999px;background:#fff}
    .chip{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border:1px dashed #FFD7C6;background:#FFF6F0;border-radius:999px;font-weight:700}
    .list{display:grid;gap:8px}
    .inline-tools{display:flex;gap:8px;flex-wrap:wrap}
    .ghost.danger{border-color:#f8c5c5;color:#b80f0f}
    .subtle{color:#666}

 /* ===== CONTACT TAB POLISH (matches your About tab look) ===== */
  .contact-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  @media(max-width:1000px){.contact-grid{grid-template-columns:1fr}}
  .contact-stack{display:grid;gap:10px}
  .contact-pill{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border:1px solid var(--line);border-radius:999px;background:#fff}
  .contact-hr{height:1px;background:var(--line);margin:12px 0}
  .mini{font-size:12px}
  .subtle{color:#666}
  .inline-tools{display:flex;gap:8px;flex-wrap:wrap}
  .ghost.danger{border-color:#f8c5c5;color:#b80f0f}
  .icon-demo{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border:1px dashed #FFD7C6;background:#FFF6F0;border-radius:999px;font-weight:700}
  .contact-note{font-size:12px;color:var(--muted)}
  .wide{grid-column:1 / -1}
</style>
</head>
<body>
<div class="app">
  <!-- Sidebar -->
  <aside class="side">
    <div class="brand">
      <div class="logo">
  <img src="assets/images/favicon.svg" alt="bndlabs logo" style="width:50px;height:auto;max-height:60px;object-fit:contain;">
</div>
      <div class="name">Bodunde CMS</div>
    </div>
    <div class="mutey">Manage</div>
    <nav class="nav" id="nav">
      <a href="#" data-panel="portfolio" class="active"><svg viewBox="0 0 24 24"><path d="M4 6h16v12H4zM9 6V4h6v2" /></svg> Portfolio</a>
      <a href="#" data-panel="blog"><svg viewBox="0 0 24 24"><path d="M4 5h16v14H4zM7 8h10M7 12h10M7 16h6"/></svg> Blog</a>
      <a href="#" data-panel="profile"><svg viewBox="0 0 24 24"><path d="M12 12a5 5 0 1 0 0-10 5 5 0 0 0 0 10Zm-8 9c0-3.3 3.6-6 8-6s8 2.7 8 6"/></svg> Profile / Settings</a>
      <a href="#" data-panel="home"><svg viewBox="0 0 24 24"><path d="M3 11l9-8 9 8v9H3z"/></svg> Home</a>
      <a href="#" data-panel="about"><svg viewBox="0 0 24 24"><path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20z"/></svg> About</a>
      <a href="#" data-panel="contact"><svg viewBox="0 0 24 24"><path d="M4 6h16v12H4zM7 9h10M7 13h7"/></svg> Contact</a>
      <a href="#" data-panel="four"><svg viewBox="0 0 24 24"><path d="M4 4h16v16H4zM9 9l6 6M15 9l-6 6"/></svg> 404</a>
    </nav>
  </aside>

  <!-- Main -->
  <main class="main">
    <div class="topbar">
      <div style="font-weight:900">Admin Dashboard</div>
      <div class="bar">
        <button id="exportBtn" class="ghost tiny">Export JSON</button>
        <label for="importFile" class="ghost tiny" style="cursor:pointer">Import JSON</label>
        <input id="importFile" type="file" accept="application/json" style="display:none">
        <button id="logout" class="ghost tiny">Log out</button>
      </div>
    </div>

    <!-- Projects list -->
    <section class="card" id="panel_portfolio">
      <div class="pad">
        <div class="toolbar">
          <div>
            <div style="font-size:18px;font-weight:900">Projects</div>
            <div style="color:var(--muted);font-size:13px">Newest first, edit or hide.</div>
          </div>
          <div class="bar">
            <input id="projSearch" class="search" placeholder="Search projects‚Ä¶">
            <select id="projFilter" class="select">
              <option value="">All statuses</option><option value="active">Active</option><option value="draft">Draft</option><option value="hidden">Hidden</option>
            </select>
            <button class="btn tiny" id="addProjBtn">‚ûï Add Project</button>
          </div>
        </div>
        <table>
          <thead><tr>
            <th style="width:34px">#</th><th>Title</th><th style="width:120px">Status</th><th style="width:100px">Views</th>
            <th style="width:140px">Tag</th><th style="width:120px">Date</th><th style="width:160px">Updated</th><th style="width:260px">Actions</th>
          </tr></thead>
          <tbody id="projBody"></tbody>
        </table>
      </div>
    </section>

    <!-- Blog list -->
    <section class="card" id="panel_blog" style="display:none">
      <div class="pad">
        <div class="toolbar">
          <div>
            <div style="font-size:18px;font-weight:900">Blog Posts</div>
            <div style="color:var(--muted);font-size:13px">Image ‚Üí Heading ‚Üí Paragraph blocks (rich-text).</div>
          </div>
          <div class="bar">
            <input id="blogSearch" class="search" placeholder="Search posts‚Ä¶">
            <select id="blogFilter" class="select">
              <option value="">All statuses</option><option value="active">Active</option><option value="draft">Draft</option><option value="hidden">Hidden</option>
            </select>
            <button class="btn tiny" id="addBlogBtn">‚ûï Add Post</button>
          </div>
        </div>
        <table>
          <thead><tr>
            <th style="width:34px">#</th><th>Title</th><th style="width:120px">Status</th><th style="width:100px">Views</th>
            <th style="width:140px">Category</th><th style="width:120px">Date</th><th style="width:160px">Updated</th><th style="width:260px">Actions</th>
          </tr></thead>
          <tbody id="blogBody"></tbody>
        </table>
      </div>
    </section>

    <!-- Project editor -->
    <section class="card" id="panel_editor_proj" style="display:none">
      <div class="pad">
        <div class="bar" style="justify-content:space-between;margin-bottom:6px">
          <div style="font-size:18px;font-weight:900" id="editorProjTitle">New Project</div>
          <div class="bar">
            <button class="ghost tiny" data-back="proj">‚üµ Back</button>
            <button class="ghost tiny" id="delProjBtn" style="display:none;color:var(--red);border-color:#432">Delete</button>
            <button class="btn tiny" id="saveProjBtn">Save</button>
          </div>
        </div>

        <div class="grid2">
          <div class="row"><label>Project Title</label><input id="p_title" class="field" placeholder="Monitor app design"></div>
          <div class="row"><label>Tag</label><input id="p_tag" class="field" placeholder="Product design"></div>
        </div>

        <div class="grid2" style="margin-top:10px">
          <div class="row"><label>Date</label><input id="p_date" class="field" placeholder="July 2014"></div>
          <div class="row">
            <label>Hero Image</label>
            <div class="uploader">
              <div class="bar" style="gap:8px"><input id="p_hero" class="field" placeholder="https://‚Ä¶"><input id="p_hero_file" type="file" accept="image/*" class="ghost tiny" style="padding:9px 10px"></div>
              <p>Upload a file or drag and drop ‚Äî PNG, JPG, SVG up to 1 MB</p>
            </div>
          </div>
        </div>
        <div class="grid2" style="margin-top:10px">
  <div class="row"><label>Project Link (Page URL)</label><input id="p_link" class="field" placeholder="project-monitor.html"></div>
</div>

        <div class="grid2" style="margin-top:10px">
          <div class="row"><label>Status</label><select id="p_status" class="field"><option value="active">Active</option><option value="draft">Draft</option><option value="hidden">Hidden</option></select></div>
          <div class="row"><label>Views</label><input id="p_views" class="field" type="number" min="0" value="0"></div>
        </div>

        <div class="row" style="margin-top:10px"><label>Short Description</label><textarea id="p_desc" class="field" placeholder="A short summary shown at the top‚Ä¶"></textarea></div>

        <div class="bar" style="margin-top:14px">
          <div style="font-weight:900">Sections</div>
          <select id="p_addType" class="field" style="max-width:240px">
            <option value="p">Paragraph</option><option value="h2">Heading</option><option value="img">Image</option>
          </select>
          <button class="ghost tiny" id="p_addSectionBtn">Add Section</button>
        </div>

        <div class="sections" id="p_sections" style="margin-top:10px"></div>
      </div>
    </section>

    <!-- Blog editor -->
    <section class="card" id="panel_editor_blog" style="display:none">
      <div class="pad">
        <div class="bar" style="justify-content:space-between;margin-bottom:6px">
          <div style="font-size:18px;font-weight:900" id="editorBlogTitle">New Blog Post</div>
          <div class="bar">
            <button class="ghost tiny" data-back="blog">‚üµ Back</button>
            <button class="ghost tiny" id="delBlogBtn" style="display:none;color:var(--red);border-color:#432">Delete</button>
            <button class="btn tiny" id="saveBlogBtn">Save</button>
          </div>
        </div>

        <div class="grid2">
          <div class="row"><label>Title</label><input id="b_title" class="field" placeholder="Designing for emotion"></div>
          <div class="row"><label>Category / Tag</label><input id="b_tag" class="field" placeholder="UI/UX"></div>
        </div>

        <div class="grid2" style="margin-top:10px">
          <div class="row"><label>Date</label><input id="b_date" class="field" placeholder="02 July 2025"></div>
          <div class="row">
            <label>Hero Image</label>
            <div class="uploader">
              <div class="bar" style="gap:8px"><input id="b_hero" class="field" placeholder="https://‚Ä¶"><input id="b_hero_file" type="file" accept="image/*" class="ghost tiny" style="padding:9px 10px"></div>
              <p>Upload a file or drag and drop ‚Äî PNG, JPG, SVG up to 1 MB</p>
            </div>
          </div>
        </div>

        <div class="grid2" style="margin-top:10px">
          <div class="row"><label>Status</label><select id="b_status" class="field"><option value="active">Active</option><option value="draft">Draft</option><option value="hidden">Hidden</option></select></div>
          <div class="row"><label>Views</label><input id="b_views" class="field" type="number" min="0" value="0"></div>
        </div>

        <div class="row" style="margin-top:10px"><label>Subtitle</label><input id="b_sub" class="field" placeholder="Short subheading for the article"></div>

        <div class="bar" style="margin-top:14px">
          <div style="font-weight:900">Sections</div>
          <select id="b_addType" class="field" style="max-width:240px">
            <option value="p">Paragraph</option><option value="h2">Heading</option><option value="img">Image</option>
          </select>
          <button class="ghost tiny" id="b_addSectionBtn">Add Section</button>
        </div>

        <div class="sections" id="b_sections" style="margin-top:10px"></div>
      </div>
    </section>

    <!-- Profile / Settings -->
    <section class="card" id="panel_profile" style="display:none">
      <div class="pad">
        <div style="font-size:18px;font-weight:900;margin-bottom:10px">Profile / Settings</div>

        <div class="grid2">
          <div class="row"><label>Your Name</label><input id="s_name" class="field" placeholder="bndlabs"></div>
          <div class="row"><label>Profession / Title</label><input id="s_title" class="field" placeholder="Product Designer & Front-end Developer"></div>
        </div>

        <div class="grid2" style="margin-top:10px">
          <div class="row"><label>Years of Experience</label><input id="s_years" class="field" type="number" min="0" placeholder="6"></div>
          <div class="row"><label>Location</label><input id="s_location" class="field" placeholder="Lagos, Nigeria"></div>
        </div>

        <div class="grid2" style="margin-top:10px">
          <div class="row"><label>Email</label><input id="s_email" class="field" placeholder="you@example.com"></div>
          <div class="row"><label>Phone</label><input id="s_phone" class="field" placeholder="+234 ‚Ä¶"></div>
        </div>

        <div class="row" style="margin-top:10px"><label>Short Bio</label><textarea id="s_bio" class="field" placeholder="A concise about-you paragraph."></textarea></div>

        <div class="row" style="margin-top:10px">
          <label>Profile Photo</label>
          <div class="uploader">
            <div class="bar" style="gap:8px"><input id="s_avatar" class="field" placeholder="https://‚Ä¶"><input id="s_avatar_file" type="file" accept="image/*" class="ghost tiny" style="padding:9px 10px"></div>
            <p>Upload a file or drag and drop ‚Äî PNG, JPG, SVG up to 1 MB</p>
          </div>
        </div>

        <div class="grid2" style="margin-top:10px">
          <div class="row"><label>X (formerly Twitter)</label><input id="s_x" class="field" placeholder="https://x.com/‚Ä¶"></div>
          <div class="row"><label>Instagram</label><input id="s_instagram" class="field" placeholder="https://instagram.com/‚Ä¶"></div>
        </div>
        <div class="grid2" style="margin-top:10px">
          <div class="row"><label>Behance</label><input id="s_behance" class="field" placeholder="https://behance.net/‚Ä¶"></div>
          <div class="row"><label>LinkedIn</label><input id="s_linkedin" class="field" placeholder="https://linkedin.com/in/‚Ä¶"></div>
        </div>

        <div class="bar" style="margin-top:16px">
          <button class="btn tiny" id="s_save">Save Profile</button>
          <span id="s_ok" style="display:none;color:var(--green);font-weight:800">Saved ‚úì</span>
        </div>
      </div>
    </section>

    <!-- Home Page Settings -->
    <section class="card" id="panel_home" style="display:none">
      <div class="pad">
        <div style="font-size:18px;font-weight:900;margin-bottom:10px">Home Page Settings</div>

        <div class="row"><label>Hero Title</label><input id="h_title" class="field" placeholder="UI/UX Designer & Developer"></div>
        <div class="row"><label>Hero Subtitle</label><textarea id="h_sub" class="field" placeholder="Short line below title‚Ä¶"></textarea></div>
        <div class="row"><label>Pill Text</label><input id="h_pill" class="field" placeholder="Design + Code"></div>

        <div class="row"><label>Projects Section Title</label><input id="h_proj_title" class="field" placeholder="Some of my latest work"></div>
        <div class="row"><label>Button Text</label><input id="h_button" class="field" placeholder="See All Work"></div>

        <div class="bar" style="margin-top:16px">
          <button class="btn tiny" id="h_save">Save Home Settings</button>
          <span id="h_ok" style="display:none;color:var(--green);font-weight:800">Saved ‚úì</span>
        </div>
      </div>
    </section>

    <!-- =========================
         ABOUT PAGE CMS TAB (Styled + Autosave)
    ========================= -->
    <section class="card" id="panel_about" style="display:none">
      <div class="pad">
        <div class="toolbar" style="margin-bottom:6px">
          <div>
            <div style="font-size:18px;font-weight:900">About Page</div>
            <div class="muted">Edit the content below. Changes auto-save to <code>cms_about</code>.</div>
          </div>
          <div class="inline-tools">
            <button class="ghost tiny" id="about_export">Export</button>
            <button class="ghost tiny danger" id="about_reset">Reset</button>
            <button class="btn tiny" id="about_save">üíæ Save About</button>
  <span id="about_ok" style="display:none;color:#16A34A;font-weight:800">Saved ‚úì</span>
          </div>
        </div>

        <!-- Hero -->
        <div class="about-stack">
          <div class="pill"><span class="material-symbols-rounded">bolt</span><strong>Hero</strong></div>
          <div class="about-grid">
            <div class="row"><label>Hero Title</label><input id="about_hero_title" class="field" placeholder="About"></div>
            <div class="row"><label>Hero Description</label><textarea id="about_hero_desc" class="field" rows="2" placeholder="Short intro paragraph"></textarea></div>
          </div>
        </div>

        <div class="hr"></div>

        <!-- Profile -->
        <div class="about-stack">
          <div class="pill"><span class="material-symbols-rounded">person</span><strong>Profile</strong></div>
          <div class="about-grid">
            <div class="row"><label>Name</label><input id="about_name" class="field" placeholder="Your full name"></div>
            <div class="row"><label>Role</label><input id="about_role" class="field" placeholder="UI/UX Designer ‚Ä¢ Front-end Developer"></div>
            <div class="row"><label>Profile Image URL</label><input id="about_image" class="field" placeholder="https://‚Ä¶yourphoto.jpg"></div>
            <div class="row"><label>R√©sum√© Link</label><input id="about_resume" class="field" placeholder="resume.pdf"></div>
            <div class="row"><label>Contact Link</label><input id="about_contact" class="field" placeholder="contact.html"></div>
            <div class="row"><label>Random Fact</label><input id="about_random" class="field" placeholder="Something fun about you"></div>
          </div>
        </div>

        <div class="hr"></div>

        <!-- Facts -->
        <div class="about-stack">
          <div class="pill"><span class="material-symbols-rounded">workspace_premium</span><strong>Facts</strong><span class="subtle mini"> (Experience / Projects / Case studies)</span></div>
          <div id="facts_list" class="list"></div>
          <button type="button" class="ghost tiny" id="add_fact">+ Add Fact</button>
        </div>

        <div class="hr"></div>

        <!-- Skills -->
        <div class="about-stack">
          <div class="pill"><span class="material-symbols-rounded">sell</span><strong>Skills (Tags)</strong></div>
          <div id="skills_list" class="list"></div>
          <button type="button" class="ghost tiny" id="add_skill">+ Add Skill</button>
        </div>

        <div class="hr"></div>

        <!-- Gallery -->
        <div class="about-stack">
          <div class="pill"><span class="material-symbols-rounded">image</span><strong>Mini Gallery</strong><span class="subtle mini"> (3 images)</span></div>
          <div id="gallery_list" class="list"></div>
          <button type="button" class="ghost tiny" id="add_gallery">+ Add Image</button>
        </div>

        <div class="hr"></div>

        <!-- Progress Bars -->
        <div class="about-stack">
          <div class="pill"><span class="material-symbols-rounded">bar_chart</span><strong>Progress Bars</strong></div>
          <div id="progress_list" class="list"></div>
          <button type="button" class="ghost tiny" id="add_progress">+ Add Progress</button>
        </div>

        <div class="hr"></div>

        <!-- Features -->
        <div class="about-stack">
          <div class="pill"><span class="material-symbols-rounded">star</span><strong>Featured Cards</strong></div>
          <div id="features_list" class="list"></div>
          <button type="button" class="ghost tiny" id="add_feature">+ Add Feature</button>
        </div>
      </div>
    </section>

    <!-- Contact -->
    <section class="card" id="panel_contact" style="display:none">
  <div class="pad">
    <div class="toolbar" style="margin-bottom:6px">
      <div>
        <div style="font-size:18px;font-weight:900">Contact Page</div>
        <div class="muted">Edit all texts, labels, image, quick-contact and socials. Changes auto-save to <code>cms_contact</code>.</div>
      </div>
      <div class="inline-tools">
        <button class="ghost tiny" id="contact_export">Export</button>
        <button class="ghost tiny danger" id="contact_reset">Reset</button>
      </div>
    </div>

    <!-- Hero -->
    <div class="contact-stack">
      <div class="contact-pill"><span class="material-symbols-rounded">bolt</span><strong>Hero</strong></div>
      <div class="contact-grid">
        <div class="row"><label>Pill Text</label><input id="c_pill" class="field" placeholder="WRITE TO US"></div>
        <div class="row"><label>Hero Title</label><input id="c_title" class="field" placeholder="Get In Touch"></div>
        <div class="row wide"><label>Subtitle</label><textarea id="c_sub" class="field" rows="2" placeholder="Get in touch with us using the enquiry form or contact details below."></textarea></div>
      </div>
    </div>

    <div class="contact-hr"></div>

    <!-- Form Labels / Texts -->
    <div class="contact-stack">
      <div class="contact-pill"><span class="material-symbols-rounded">edit</span><strong>Form</strong> <span class="subtle mini"> (labels, CTA, notices, consents)</span></div>
      <div class="contact-grid">
        <div class="row"><label>First Name Label</label><input id="c_label_first" class="field" placeholder="First Name"></div>
        <div class="row"><label>Last Name Label</label><input id="c_label_last" class="field" placeholder="Last Name"></div>
        <div class="row"><label>Email Label</label><input id="c_label_email" class="field" placeholder="Email"></div>
        <div class="row"><label>Message Label</label><input id="c_label_message" class="field" placeholder="Message"></div>

        <div class="row wide"><label>Consent #1</label><input id="c_consent_1" class="field" placeholder="I agree to receive other communication messages."></div>
        <div class="row wide"><label>Consent #2</label><input id="c_consent_2" class="field" placeholder="I give my consent to bndlabs to store my data."></div>

        <div class="row wide"><label>Privacy Note</label><input id="c_privacy" class="field" placeholder="We respect your privacy. You can opt out at any time."></div>
        <div class="row"><label>Submit Button Text</label><input id="c_button" class="field" placeholder="Send Message"></div>
      </div>
      <div class="contact-note">* These map 1:1 to your current contact form fields on the site.</div>
    </div>

    <div class="contact-hr"></div>

    <!-- Sidebar (Image + Quick Contact) -->
    <div class="contact-stack">
      <div class="contact-pill"><span class="material-symbols-rounded">image</span><strong>Sidebar</strong> <span class="subtle mini"> (right column)</span></div>
      <div class="contact-grid">
        <div class="row wide"><label>Sidebar Image URL</label><input id="c_image" class="field" placeholder="https://‚Ä¶"></div>

        <div class="row"><label>Quick Contact Title</label><input id="c_qc_title" class="field" placeholder="Quick Contact"></div>

        <div class="row"><label>Email Label</label><input id="c_qc_email_label" class="field" placeholder="Email"></div>
        <div class="row"><label>Email Value</label><input id="c_qc_email_value" class="field" placeholder="hello@bndlabs.dev"></div>

        <div class="row"><label>Phone Label</label><input id="c_qc_phone_label" class="field" placeholder="Phone Number"></div>
        <div class="row"><label>Phone Value</label><input id="c_qc_phone_value" class="field" placeholder="+234 ‚Ä¶"></div>

        <div class="row"><label>HQ Label</label><input id="c_qc_hq_label" class="field" placeholder="Headquarter"></div>
        <div class="row"><label>HQ Value</label><input id="c_qc_hq_value" class="field" placeholder="Lagos, Nigeria"></div>
      </div>
    </div>

    <div class="contact-hr"></div>

    <!-- Socials -->
    <div class="contact-stack">
      <div class="contact-pill"><span class="material-symbols-rounded">share</span><strong>Socials</strong></div>
      <div class="row"><label>Follow Title</label><input id="c_follow_title" class="field" placeholder="Follow us"></div>

      <div id="contact_socials" class="contact-stack"></div>
      <div class="inline-tools">
        <button type="button" class="ghost tiny" id="add_social">+ Add Social</button>
        <span class="icon-demo mini">Tip: Choose Platform + Link. Optional custom SVG overrides the default.</span>
      </div>
      <div class="bar" style="margin-top:16px">
  <button class="btn tiny" id="saveContactBtn">üíæ Save Contact</button>
  <span id="contactSaved" style="display:none;color:var(--green);font-weight:800">Saved ‚úì</span>
</div>
    </div>
  </div>
</section>

    <!-- =========================
   404 PAGE CMS TAB
========================= -->
<section class="card" id="panel_four" style="display:none">
  <div class="pad">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
      <div style="font-size:18px;font-weight:900">404 Page Settings</div>
      <div style="color:var(--muted);font-size:13px">Autosaves to <code>cms_404</code></div>
    </div>

    <div class="row">
      <label>Primary Title</label>
      <input id="four_title" class="field" placeholder="Hmmm..." />
    </div>

    <div class="row" style="margin-top:8px">
      <label>Line 1 (short)</label>
      <input id="four_line1" class="field" placeholder="Occurred, a 404 error has. I sense much fear in you." />
    </div>

    <div class="row" style="margin-top:8px">
      <label>Line 2 (long)</label>
      <textarea id="four_line2" class="field" rows="3" placeholder="Trust in the force..."></textarea>
    </div>

    <div style="margin-top:12px;display:grid;grid-template-columns:1fr 1fr;gap:10px">
      <div class="row">
        <label>Button A Label (primary)</label>
        <input id="four_btn_do_label" class="field" placeholder="Do" />
      </div>
      <div class="row">
        <label>Button A Link</label>
        <input id="four_btn_do_link" class="field" placeholder="home.html" />
      </div>
    </div>

    <div style="margin-top:12px;display:grid;grid-template-columns:1fr 1fr;gap:10px">
      <div class="row">
        <label>Button B Label (secondary)</label>
        <input id="four_btn_donot_label" class="field" placeholder="Do not" />
      </div>
      <div class="row">
        <label>Button B Link</label>
        <input id="four_btn_donot_link" class="field" placeholder="home.html" />
      </div>
    </div>

    <div style="margin-top:12px;display:grid;grid-template-columns:1fr 1fr;gap:10px;align-items:center">
      <div>
        <label>Button C Label (try)</label>
        <input id="four_btn_try_label" class="field" placeholder="Try" />
      </div>
      <div style="display:flex;gap:8px;align-items:center">
        <label style="font-size:12px;color:var(--muted);margin:0">Disable Try</label>
        <input type="checkbox" id="four_try_disabled" style="transform:scale(1.1)" />
      </div>
    </div>

    <div style="margin-top:12px">
      <label>Hero / Yoda Image URL</label>
      <input id="four_image" class="field" placeholder="https://‚Ä¶" />
      <div style="font-size:12px;color:var(--muted);margin-top:6px">Leave blank to use default image in your page.</div>
    </div>

    <hr style="margin:18px 0">

    <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap">
      <label style="margin:0;font-weight:800">Latest work</label>
      <label style="margin:0;font-size:13px;color:var(--muted)">Use latest N posted projects on homepage (auto)</label>
      <input id="four_latest_count" class="field" style="max-width:120px" type="number" min="0" value="3">
      <label style="display:flex;align-items:center;gap:8px;margin-left:6px">
        <input type="checkbox" id="four_use_latest" />
        <span style="font-size:13px;color:var(--muted)">Auto: use latest posts</span>
      </label>
    </div>

    <div style="margin-top:12px">
      <label>Custom project IDs (comma-separated) ‚Äî optional (ignored if Auto is on)</label>
      <input id="four_custom_projects" class="field" placeholder="id1,id2,id3" />
      <div style="font-size:12px;color:var(--muted);margin-top:6px">If you want specific projects to appear, add their IDs here.</div>
    </div>

    <hr style="margin:18px 0">

    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;align-items:center">
      <label>Remove underline from header nav links on public pages?</label>
      <label style="display:flex;gap:8px;align-items:center">
        <input type="checkbox" id="four_remove_nav_underline" />
        <span style="color:var(--muted);font-size:13px">Remove underline</span>
      </label>
    </div>

    <div style="margin-top:14px;display:flex;gap:12px;align-items:center">
      <button id="four_save" class="btn tiny">Save 404</button>
      <span id="four_saved" style="display:none;color:var(--green);font-weight:800">Saved ‚úì</span>
      <button id="four_clear" class="ghost tiny" style="margin-left:8px">Clear</button>
    </div>

    <div style="margin-top:10px;color:var(--muted);font-size:13px">Tip: enable "Auto" to show the latest <em>N</em> projects from Projects list.</div>
  </div>
</section>

  </main>
</div>

<!-- Password Gate -->
<div class="gate" id="gate">
  <div class="login">
    <div class="login-head">bndlabs Admin Login</div>
    <div class="login-body">
      <div class="row"><label>Password</label><input id="pass" type="password" class="field" placeholder="Enter password"></div>
      <div class="bar" style="margin-top:10px">
        <button class="btn" id="enter">Enter</button>
        <span style="color:var(--muted);font-size:12px">Change inside code: <code>PASSWORD</code></span>
      </div>
    </div>
  </div>
</div>
 
<script>
/* ===== Storage Keys ===== */
const LS_PROJECTS='cms_projects', LS_BLOGS='cms_blogs', LS_PROFILE='cms_profile', LS_HOME='cms_home', LS_ABOUT='cms_about', LS_CONTACT='cms_contact';


/* ===== Shortcuts ===== */
const $=s=>document.querySelector(s), $$=s=>document.querySelectorAll(s);
const fmtTime=t=>!t?'‚Äî':new Date(t).toLocaleString(); const esc=s=>String(s||'').replace(/[&<>"]*/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c]));


/* ===== Secure Password Gate (for Bodunde6056$) ===== */
const gate = document.getElementById("gate");
const pass = document.getElementById("pass");
const enter = document.getElementById("enter");
const logout = document.getElementById("logout");

// Correct hidden hash of "Bodunde6056$"
const hiddenHash = "426f64756e64653630353624"; // one-way UTF-8 hex hash

function hashString(str) {
  return Array.from(new TextEncoder().encode(str))
    .reduce((acc, b) => acc + b.toString(16).padStart(2, "0"), "");
}


// ===========================================
// ADMIN LOGIN ‚Äî JWT AUTH WITH YOUR BACKEND
// ===========================================

enter.addEventListener("click", async () => {
  const password = pass.value.trim();
  if (!password) {
    alert("Enter password");
    return;
  }

  try {
    // login to backend
    const res = await fetch("https://bndlabs-backend.onrender.com/api/auth/login", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ password })
    });

    const data = await res.json();

    if (!res.ok || !data.ok) {
      alert("Incorrect password");
      return;
    }

    // Save token
    sessionStorage.setItem("bnd_token", data.token);
    sessionStorage.setItem("bod_authed", "yes");

    // Hide login
    gate.style.display = "none";
    pass.value = "";
  } catch (err) {
    alert("Login failed");
  }
});

// Handle Enter key
pass.addEventListener("keydown", (e) => {
  if (e.key === "Enter") {
    e.preventDefault();
    enter.click();
  }
});

// Logout button
logout.addEventListener("click", () => {
  sessionStorage.removeItem("bod_authed");
  gate.style.display = "flex";
});

// press Enter key
if (pass) {
  pass.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') {
      e.preventDefault();
      enter.click();
    }
  });
}

// logout
if (logout) {
  logout.addEventListener('click', () => {
    gate.style.display = 'flex';
    sessionStorage.removeItem('bod_authed');
  });
}

/* ===== Nav Panels ===== */
$('#nav').addEventListener('click',e=>{
  const a=e.target.closest('a'); if(!a) return; e.preventDefault();
  $$('.nav a').forEach(x=>x.classList.remove('active')); a.classList.add('active');
  $$('section.card').forEach(p=>p.style.display='none');
  const key=a.dataset.panel; const panel=$('#panel_'+key); if(panel) panel.style.display='block';

  if(key==='portfolio') renderProjects();
  if(key==='blog') renderBlogs();
  if(key==='profile') loadProfile();
  if(key==='home') loadHome();
  if(key==='about') loadAbout();         // <= show & hydrate About only on click
  if(key==='contact') loadContact();      // <= hydrate Contact only on click
});

/* ===== Search + Filters ===== */
$('#projSearch').oninput=renderProjects; $('#projFilter').onchange=renderProjects;
$('#blogSearch').oninput=renderBlogs;   $('#blogFilter').onchange=renderBlogs;

/* ===== Lists ===== */
const projBody=$('#projBody'), blogBody=$('#blogBody');

function renderProjects(){
  const q=($('#projSearch').value||'').toLowerCase(), f=$('#projFilter').value;
  const list=Store.projects().filter(p=>{
    const okQ=!q || [p.title,p.tag,p.date].join(' ').toLowerCase().includes(q);
    const okF=!f || (p.status||'active')===f; return okQ&&okF;
  });
  projBody.innerHTML='';
  if(!list.length){ projBody.innerHTML='<tr><td colspan="8" style="color:#666">No projects found.</td></tr>'; return; }
  list.forEach((p,i)=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`
      <td>${i+1}</td>
      <td>${esc(p.title||'‚Äî')}</td>
      <td><span class="status" data-s="${esc(p.status||'active')}">${(p.status||'active').toUpperCase()}</span></td>
      <td>${Number(p.views||0)}</td>
      <td><span class="tag">${esc(p.tag||'‚Äî')}</span></td>
      <td>${esc(p.date||'‚Äî')}</td>
      <td>${fmtTime(p.updated)}</td>
      <td class="tools">
        <button class="ghost tiny" data-edit="${p.id}">‚úèÔ∏è Edit</button>
        <button class="ghost tiny" data-toggle="${p.id}">${(p.status||'active')==='hidden'?'üëÅÔ∏è Show':'üôà Hide'}</button>
        <button class="ghost tiny" data-del="${p.id}" style="color:#DC2626;border-color:#F3C0C0">üóëÔ∏è Delete</button>
      </td>`;
    projBody.appendChild(tr);
  });
}
if (window.Store) {
  renderProjects();
} else {
  setTimeout(() => {
    if (window.Store) renderProjects();
  }, 1000);
}

projBody.addEventListener('click',e=>{
  const id=e.target.getAttribute('data-edit'), del=e.target.getAttribute('data-del'), tog=e.target.getAttribute('data-toggle');
  if(id) openProjEditor(Store.byIdProject(id));
  if(del && confirm('Delete this project?')){ Store.removeProject(del); renderProjects(); }
  if(tog){ const it=Store.byIdProject(tog); if(it){ it.status=(it.status==='hidden'?'active':'hidden'); Store.putProject(it); renderProjects(); } }
});

function renderBlogs(){
  const q=($('#blogSearch').value||'').toLowerCase(), f=$('#blogFilter').value;
  const list=Store.blogs().filter(b=>{
    const okQ=!q || [b.title,b.tag,b.date,b.subtitle].join(' ').toLowerCase().includes(q);
    const okF=!f || (b.status||'active')===f; return okQ&&okF;
  });
  blogBody.innerHTML='';
  if(!list.length){ blogBody.innerHTML='<tr><td colspan="8" style="color:#666">No posts found.</td></tr>'; return; }
  list.forEach((b,i)=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`
      <td>${i+1}</td>
      <td>${esc(b.title||'‚Äî')}</td>
      <td><span class="status" data-s="${esc(b.status||'active')}">${(b.status||'active').toUpperCase()}</span></td>
      <td>${Number(b.views||0)}</td>
      <td><span class="tag">${esc(b.tag||'‚Äî')}</span></td>
      <td>${esc(b.date||'‚Äî')}</td>
      <td>${fmtTime(b.updated)}</td>
      <td class="tools">
        <button class="ghost tiny" data-bed="${b.id}">‚úèÔ∏è Edit</button>
        <button class="ghost tiny" data-btoggle="${b.id}">${(b.status||'active')==='hidden'?'üëÅÔ∏è Show':'üôà Hide'}</button>
        <button class="ghost tiny" data-bdel="${b.id}" style="color:#DC2626;border-color:#F3C0C0">üóëÔ∏è Delete</button>
      </td>`;
    blogBody.appendChild(tr);
  });
}
if (window.Store) {
  renderBlogs();
} else {
  setTimeout(() => {
    if (window.Store) renderBlogs();
  }, 1000);
}
blogBody.addEventListener('click',e=>{
  const id=e.target.getAttribute('data-bed'), del=e.target.getAttribute('data-bdel'), tog=e.target.getAttribute('data-btoggle');
  if(id) openBlogEditor(Store.byIdBlog(id));
  if(del && confirm('Delete this post?')){ Store.removeBlog(del); renderBlogs(); }
  if(tog){ const it=Store.byIdBlog(tog); if(it){ it.status=(it.status==='hidden'?'active':'hidden'); Store.putBlog(it); renderBlogs(); } }
});

/* ===== Editor: Projects ===== */
$('#addProjBtn').onclick=()=>openProjEditor(null);
const p_sections=$('#p_sections');

function openProjEditor(project){
  $('#panel_portfolio').style.display='none'; $('#panel_editor_proj').style.display='block';
  $('#editorProjTitle').textContent=project?'Edit Project':'New Project';
  $('#delProjBtn').style.display=project?'inline-block':'none';

  $('#p_title').value=project?.title||''; $('#p_tag').value=project?.tag||'';
  $('#p_date').value=project?.date||'';   $('#p_desc').value=project?.desc||'';
  $('#p_hero').value=project?.hero||'';   $('#p_status').value=project?.status||'active';
  $('#p_views').value=Number(project?.views||0); $('#p_hero_file').value='';
  $('#p_link').value=project?.link||'';

  p_sections.innerHTML=''; (project?.sections||[]).forEach(s=> addSectionUI(p_sections,s.type,s.value,s.alt));
  $('#p_addSectionBtn').onclick=()=> addSectionUI(p_sections,$('#p_addType').value,'','');
  $('#delProjBtn').onclick=()=>{ if(project?.id && confirm('Delete this project?')){ Store.removeProject(project.id); backTo('proj'); } };
  $('#saveProjBtn').onclick=()=> saveProject(project?.id||null);
  document.querySelector('[data-back="proj"]').onclick=()=>backTo('proj');
}

function saveProject(id){
  const obj = {
    id:id||null,
    title:$('#p_title').value.trim(),
    tag:$('#p_tag').value.trim(),
    date:$('#p_date').value.trim(),
    desc:$('#p_desc').value.trim(),
    hero:$('#p_hero').value.trim(),
    link:$('#p_link').value.trim(), // ‚úÖ add this line
    status:$('#p_status').value,
    views:Number($('#p_views').value||0),
    sections:collectSections(p_sections)
  };
  const f = $('#p_hero_file').files?.[0];
  if(f){
    const r = new FileReader();
    r.onload = ()=>{ obj.hero=r.result; Store.putProject(obj); backTo('proj'); };
    r.readAsDataURL(f);
  } else {
    Store.putProject(obj);
    backTo('proj');
  }
}

/* ===== Editor: Blogs ===== */
$('#addBlogBtn').onclick=()=>openBlogEditor(null);
const b_sections=$('#b_sections');

function openBlogEditor(post){
  $('#panel_blog').style.display='none'; $('#panel_editor_blog').style.display='block';
  $('#editorBlogTitle').textContent=post?'Edit Blog Post':'New Blog Post';
  $('#delBlogBtn').style.display=post?'inline-block':'none';

  $('#b_title').value=post?.title||''; $('#b_tag').value=post?.tag||'';
  $('#b_date').value=post?.date||'';   $('#b_sub').value=post?.subtitle||'';
  $('#b_hero').value=post?.hero||'';   $('#b_status').value=post?.status||'active';
  $('#b_views').value=Number(post?.views||0); $('#b_hero_file').value='';

  b_sections.innerHTML=''; (post?.sections||[]).forEach(s=> addSectionUI(b_sections,s.type,s.value,s.alt));
  $('#b_addSectionBtn').onclick=()=> addSectionUI(b_sections,$('#b_addType').value,'','');
  $('#delBlogBtn').onclick=()=>{ if(post?.id && confirm('Delete this post?')){ Store.removeBlog(post.id); backTo('blog'); } };
  $('#saveBlogBtn').onclick=()=> saveBlog(post?.id||null);
  document.querySelector('[data-back="blog"]').onclick=()=>backTo('blog');
}

function saveBlog(id){
  const prof=Store.profile();
  const obj={
    id:id||null, title:$('#b_title').value.trim(), tag:$('#b_tag').value.trim(), date:$('#b_date').value.trim(),
    subtitle:$('#b_sub').value.trim(), hero:$('#b_hero').value.trim(),
    status:$('#b_status').value, views:Number($('#b_views').value||0),
    sections:collectSections(b_sections), author:prof.name||'', authorAvatar:prof.avatar||''
  };
  const f=$('#b_hero_file').files?.[0];
  if(f){ const r=new FileReader(); r.onload=()=>{ obj.hero=r.result; Store.putBlog(obj); backTo('blog'); }; r.readAsDataURL(f); }
  else { Store.putBlog(obj); backTo('blog'); }
}

/* ===== Sections Builder (shared) ===== */
function addSectionUI(host,type,value='',alt=''){
  const el=document.createElement('div'); el.className='section';
  el.innerHTML=`<div class="s-head">
      <div class="s-title">${type.toUpperCase()}</div>
      <div class="s-tools">
        <button class="iconbtn" data-up>‚¨Ü</button>
        <button class="iconbtn" data-down>‚¨á</button>
        <button class="iconbtn" data-remove style="color:#DC2626">‚úñ</button>
      </div>
    </div>
    <div class="row s-body"></div>`;
  const body=el.querySelector('.s-body');

  function render(kind){
    body.innerHTML='';
    el.querySelector('.s-title').textContent=(kind==='h2'?'H2':kind.toUpperCase());

    const hasText = kind==='p' || kind==='h2';
    if(hasText){
      body.innerHTML=`
        <div class="rte">
          <div class="dropdown">
            <button class="dd-btn" type="button" data-ddbtn>
              <span data-ddlabel>${kind==='h2'?'Heading':'Paragraph'}</span>
              <span class="material-symbols-rounded">arrow_drop_down</span>
            </button>
            <div class="dd" data-dd>
              <button type="button" data-type="p">Paragraph</button>
              <button type="button" data-type="h2">Heading</button>
              <button type="button" data-type="img">Image</button>
            </div>
          </div>
          <button class="btn" data-cmd="bold" title="Bold"><span class="material-symbols-rounded">format_bold</span></button>
          <button class="btn" data-cmd="italic" title="Italic"><span class="material-symbols-rounded">format_italic</span></button>
          <button class="btn" data-cmd="underline" title="Underline"><span class="material-symbols-rounded">format_underlined</span></button>
          <button class="btn" data-link title="Link"><span class="material-symbols-rounded">link</span></button>
          <button class="btn" data-cmd="insertUnorderedList" title="Bulleted list"><span class="material-symbols-rounded">format_list_bulleted</span></button>
          <button class="btn" data-cmd="insertOrderedList" title="Numbered list"><span class="material-symbols-rounded">format_list_numbered</span></button>
          <button class="btn" data-cmd="justifyLeft" title="Align left"><span class="material-symbols-rounded">format_align_left</span></button>
          <button class="btn" data-cmd="justifyCenter" title="Align center"><span class="material-symbols-rounded">format_align_center</span></button>
          <button class="btn" data-cmd="justifyRight" title="Align right"><span class="material-symbols-rounded">format_align_right</span></button>
          <button class="btn" data-cmd="undo" title="Undo"><span class="material-symbols-rounded">undo</span></button>
          <button class="btn" data-cmd="redo" title="Redo"><span class="material-symbols-rounded">redo</span></button>
        </div>
        <div class="rich" contenteditable="true" data-editor>${value||''}</div>`;

      const ddBtn=body.querySelector('[data-ddbtn]'), dd=body.querySelector('[data-dd]'), ddLabel=body.querySelector('[data-ddlabel]');
      ddBtn.onclick=()=>{ dd.style.display=dd.style.display==='block'?'none':'block'; };
      dd.querySelectorAll('button').forEach(b=> b.onclick=()=>{
        dd.style.display='none';
        const t=b.getAttribute('data-type');
        if(t==='p'){ ddLabel.textContent='Paragraph'; render('p'); }
        else if(t==='h2'){ ddLabel.textContent='Heading'; render('h2'); }
        else if(t==='img'){ render('img'); }
      });

      const area=body.querySelector('[data-editor]');
      body.querySelectorAll('[data-cmd]').forEach(btn=>{
        btn.onclick=()=>{ area.focus(); document.execCommand(btn.getAttribute('data-cmd'),false,null); };
      });
      body.querySelector('[data-link]').onclick=()=>{
        area.focus();
        const url=prompt('Enter URL (https://‚Ä¶)'); if(url) document.execCommand('createLink',false,url);
      };
      area.addEventListener('paste',e=>{
        e.preventDefault(); const txt=(e.clipboardData||window.clipboardData).getData('text/plain'); document.execCommand('insertText',false,txt);
      });

    } else {
      body.innerHTML=`
        <div class="rte">
          <div class="dropdown">
            <button class="dd-btn" type="button" data-ddbtn>
              <span data-ddlabel>Image</span>
              <span class="material-symbols-rounded">arrow_drop_down</span>
            </button>
            <div class="dd" data-dd>
              <button type="button" data-type="p">Paragraph</button>
              <button type="button" data-type="h2">Heading</button>
              <button type="button" data-type="img">Image</button>
            </div>
          </div>
        </div>
        <div class="uploader">
          <div class="bar" style="gap:8px">
            <input class="field s-val" placeholder="https://‚Ä¶" value="${esc(value)}">
            <input type="file" accept="image/*" class="ghost tiny s-file" style="padding:9px 10px">
          </div>
          <p>Upload a file or drag and drop ‚Äî PNG, JPG, SVG up to 1 MB</p>
        </div>
        <div class="row" style="margin-top:6px"><label>Alt text</label><input class="field s-alt" placeholder="Describe the image" value="${esc(alt)}"></div>`;

      const ddBtn=body.querySelector('[data-ddbtn]'), dd=body.querySelector('[data-dd]');
      ddBtn.onclick=()=>{ dd.style.display=dd.style.display==='block'?'none':'block'; };
      dd.querySelectorAll('button').forEach(b=> b.onclick=()=>{ dd.style.display='none'; const t=b.getAttribute('data-type'); if(t==='img')return; render(t); });

      body.querySelector('.s-file').addEventListener('change',e=>{
        const f=e.target.files?.[0]; if(!f) return;
        const r=new FileReader(); r.onload=()=>{ body.querySelector('.s-val').value=r.result; }; r.readAsDataURL(f);
      });
    }
  }
  render(type);

  el.querySelector('[data-up]').onclick=()=>{ const i=[...host.children].indexOf(el); if(i>0) host.insertBefore(el,host.children[i-1]); };
  el.querySelector('[data-down]').onclick=()=>{ const i=[...host.children].indexOf(el); if(i<host.children.length-1) host.insertBefore(el,host.children[i+2]||null); };
  el.querySelector('[data-remove]').onclick=()=> el.remove();

  host.appendChild(el);
}

function collectSections(host){
  const out=[];
  host.querySelectorAll('.section').forEach(sec=>{
    const kind=sec.querySelector('.s-title').textContent.trim().toLowerCase();
    const k = (kind==='h2' || kind==='heading') ? 'h2' : kind;
    if(k==='img'){
      const v=sec.querySelector('.s-val')?.value||''; const alt=sec.querySelector('.s-alt')?.value||'';
      if(v||alt) out.push({type:'img', value:v, alt});
    }else{
      const html=sec.querySelector('[data-editor]')?.innerHTML.trim()||'';
      if(html) out.push({type:k, value:html});
    }
  });
  return out;
}

function backTo(which){
  if(which==='proj'){ $('#panel_editor_proj').style.display='none'; $('#panel_portfolio').style.display='block'; renderProjects(); }
  if(which==='blog'){ $('#panel_editor_blog').style.display='none'; $('#panel_blog').style.display='block'; renderBlogs(); }
}

/* ===== Profile ===== */
function loadProfile(){
  const p=Store.profile();
  $('#s_name').value=p.name||''; $('#s_title').value=p.title||''; $('#s_years').value=p.years||'';
  $('#s_location').value=p.location||''; $('#s_email').value=p.email||''; $('#s_phone').value=p.phone||'';
  $('#s_bio').value=p.bio||''; $('#s_avatar').value=p.avatar||'';
  $('#s_x').value=p.x||''; $('#s_instagram').value=p.instagram||''; $('#s_behance').value=p.behance||''; $('#s_linkedin').value=p.linkedin||'';
}
$('#s_save').onclick=()=>{
  const prof={
    name:$('#s_name').value.trim(), title:$('#s_title').value.trim(), years:Number($('#s_years').value||0),
    location:$('#s_location').value.trim(), email:$('#s_email').value.trim(), phone:$('#s_phone').value.trim(),
    bio:$('#s_bio').value.trim(), avatar:$('#s_avatar').value.trim(),
    x:$('#s_x').value.trim(), instagram:$('#s_instagram').value.trim(),
    behance:$('#s_behance').value.trim(), linkedin:$('#s_linkedin').value.trim()
  };
  Store.saveProfile(prof); $('#s_ok').style.display='inline'; setTimeout(()=>$('#s_ok').style.display='none',1200);
};
$('#s_avatar_file').addEventListener('change',e=>{
  const f=e.target.files?.[0]; if(!f) return; const r=new FileReader(); r.onload=()=>$('#s_avatar').value=r.result; r.readAsDataURL(f);
});

/* ===== Home Settings ===== */
function loadHome(){
  const h=Store.read(LS_HOME,'{}');
  $('#h_title').value=h.title||'';
  $('#h_sub').value=h.sub||'';
  $('#h_pill').value=h.pill||'';
  $('#h_proj_title').value=h.proj_title||'';
  $('#h_button').value=h.button||'';
}
$('#h_save').onclick=()=>{
  const obj={
    title:$('#h_title').value.trim(),
    sub:$('#h_sub').value.trim(),
    pill:$('#h_pill').value.trim(),
    proj_title:$('#h_proj_title').value.trim(),
    button:$('#h_button').value.trim()
  };
  Store.write(LS_HOME,obj);
  $('#h_ok').style.display='inline';
  setTimeout(()=>$('#h_ok').style.display='none',1200);
};

/* ===== Export / Import (global) ===== */
$('#exportBtn').onclick = () => {
  const data = {
    projects: Store.projects(),
    blogs: Store.blogs(),
    profile: Store.profile(),
    about: Store.read(LS_ABOUT, '{}'),
    contact: Store.read(LS_CONTACT, '{}'),
    home: Store.read(LS_HOME, '{}')
  };
  const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'bndlabs-cms.json';
  a.click();
  URL.revokeObjectURL(url);
};
$('#importFile').addEventListener('change', e => {
  const f = e.target.files?.[0];
  if (!f) return;
  const r = new FileReader();
  r.onload = async () => {
    try {
      const j = JSON.parse(r.result);
      if (Array.isArray(j)) {
        alert('Unsupported JSON format.');
      } else {
        if (j.projects) await Store.write(LS_PROJECTS, j.projects);
        if (j.blogs) await Store.write(LS_BLOGS, j.blogs);
        if (j.profile) await Store.write(LS_PROFILE, j.profile);
        if (j.about) await Store.write(LS_ABOUT, j.about);
        if (j.home) await Store.write(LS_HOME, j.home);
        if (j.contact) await Store.write(LS_CONTACT, j.contact);
      }
   if (window.Store) {
  renderProjects();
  renderBlogs();
  loadProfile();
} else {
  setTimeout(() => {
    if (window.Store) {
      renderProjects();
      renderBlogs();
      loadProfile();
    }
  }, 1000);
}
alert('Imported successfully');

    } catch (err) {
      alert('Import failed: ' + err.message);
    }
  };
  r.readAsText(f);
});
/* =========================
   ABOUT TAB: AUTOSAVE + UI
========================= */

// NOTE: This file is intended to *continue* the admin script from where it left off.
// It implements the remaining admin UI behavior: About autosave, Contact autosave,
// 404 handling, Store write helpers, backend sync fallbacks, and some small helpers
// referenced by the HTML. It expects `Store`, `CMSauth`, and UI elements to exist
// (they are present earlier in your HTML). It uses the same storage key constants.

(function(){
  'use strict';

  // --- Helpers ---
  function qs(sel, root=document){ return root.querySelector(sel); }
  function qsa(sel, root=document){ return [...root.querySelectorAll(sel)]; }
  function show(el){ if(!el) return; el.style.display='inline'; }
  function hide(el){ if(!el) return; el.style.display='none'; }

  // XHR / fetch helpers that prefer CMSauth when available
  async function apiPost(endpoint, payload){
    // Accept either full URL or endpoint name
    try {
      if(window.CMSauth && typeof window.CMSauth.postWithAuth === 'function'){
        return await window.CMSauth.postWithAuth(endpoint, payload);
      }
      const base = (window.BNDLABS_API_BASE || '').replace(/\/+$/,'') + '/api/';
      const url = endpoint.startsWith('http') ? endpoint : base + endpoint.replace(/^\/+/, '');
      const r = await fetch(url, {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(payload)});
      if(!r.ok) throw new Error('API POST failed ' + r.status);
      return r.json().catch(()=>({ok:true}));
    } catch(err){
      console.warn('apiPost error', err);
      throw err;
    }
  }

  // Simple visual 'saved' pop
  function flashSaved(id, ms=1400){ const el = document.getElementById(id); if(!el) return; el.style.display='inline'; setTimeout(()=>el.style.display='none', ms); }

  /* ======================================================
     ABOUT: wire up autosave, add/remove list items, export
     ====================================================== */
  const AboutUI = {
    init(){
      // elements were previously attached in the missing portion ‚Äî ensure they exist
      About.el.facts = qs('#facts_list');
      About.el.skills = qs('#skills_list');
      About.el.gallery = qs('#gallery_list');
      About.el.progress = qs('#progress_list');
      About.el.features = qs('#features_list');

      // rebind add buttons (defensive: if already bound, replace)
      const safe = (sel, fn)=>{ const el=qs(sel); if(!el) return; el.onclick = fn; };
      safe('#add_fact', ()=>{ About.addFact(); debouncedSaveAbout(); });
      safe('#add_skill', ()=>{ About.addSkill(); debouncedSaveAbout(); });
      safe('#add_gallery', ()=>{ About.addGallery(); debouncedSaveAbout(); });
      safe('#add_progress', ()=>{ About.addProgress(); debouncedSaveAbout(); });
      safe('#add_feature', ()=>{ About.addFeature(); debouncedSaveAbout(); });

      // delegate remove buttons and inputs for autosave
      const panel = qs('#panel_about');
      if(panel){
        panel.addEventListener('click', e=>{ if(e.target.matches('[data-remove]')){ e.target.closest('[data-item]').remove(); debouncedSaveAbout(); } });
        panel.addEventListener('input', (e)=>{ if(e.target.matches('input,textarea,select')) debouncedSaveAbout(); });
      }

      // manual export already wired earlier. manual save already wired earlier.
    }
  };

  // Debounce utility (re-define to ensure closure)
  function debounceFn(fn, ms=800){ let t; return (...a)=>{ clearTimeout(t); t=setTimeout(()=>fn(...a), ms); }; }
  const debouncedSaveAbout = debounceFn(()=>{ try{ const payload = About.gather(); Store.write(LS_ABOUT, payload); }catch(e){ console.warn('About save failed', e); } }, 800);

  // Expose loadAbout initializer that other code expects
  window.loadAbout = function(){ try{ AboutUI.init(); }catch(e){ console.warn('loadAbout init err', e);} };

  /* ======================================================
     CONTACT: wire up autosave, socials builder, defaults
     ====================================================== */
  const ContactUI = {
    init(){
      Contact.root = qs('#panel_contact');
      Contact.socialsRoot = qs('#contact_socials');

      // add social button
      const addBtn = qs('#add_social'); if(addBtn) addBtn.onclick = ()=>{ Contact.addSocial(); debouncedSaveContact(); };

      // remove via delegation
      if(Contact.root) Contact.root.addEventListener('click', e=>{ if(e.target.matches('[data-remove]')){ e.target.closest('[data-item="social"]').remove(); debouncedSaveContact(); } });

      // autosave input
      if(Contact.root) Contact.root.addEventListener('input', e=>{ if(e.target.matches('input,textarea,select')) debouncedSaveContact(); });

      // export / reset already wired earlier
    }
  };

  const debouncedSaveContact = debounceFn(()=>{ try{ const payload = Contact.gather(); Store.write(LS_CONTACT, payload); }catch(e){ console.warn('contact save failed', e); } }, 600);

  window.loadContact = function(){ try{ ContactUI.init(); }catch(e){ console.warn('loadContact err', e); } };

  /* ======================================================
     404: load & save helpers (ensures UI buttons work)
     ====================================================== */
  window.loadFour = window.loadFour || (function(){
    // already implemented earlier in your partial file; keep a safe wrapper
    try{ const el = document.querySelector('[data-panel="four"]'); if(el){ el.addEventListener('click', ()=> setTimeout(()=>{ try{ const fn = window.loadFour; if(typeof fn==='function') fn(); }catch{} }, 60)); } }catch(e){}
  });

  /* ======================================================
     EXPORT / IMPORT: ensure import uses Store.write properly
     ====================================================== */
  // import logic was wired earlier. We'll add a safety wrapper so imported objects
  // are normalized and backend-synced via Store.write.
  async function normalizeAndWriteImports(data){
    try{
      if(data.projects) await Store.write(LS_PROJECTS, Array.isArray(data.projects)?data.projects:[]);
      if(data.blogs) await Store.write(LS_BLOGS, Array.isArray(data.blogs)?data.blogs:[]);
      if(data.profile) await Store.write(LS_PROFILE, typeof data.profile==='object'?data.profile:{});
      if(data.about) await Store.write(LS_ABOUT, typeof data.about==='object'?data.about:{});
      if(data.home) await Store.write(LS_HOME, typeof data.home==='object'?data.home:{});
      if(data.contact) await Store.write(LS_CONTACT, typeof data.contact==='object'?data.contact:{});
      // after write, re-render UI
      try{ renderProjects(); renderBlogs(); loadProfile(); }catch(e){}
      alert('Imported successfully');
    }catch(err){ alert('Import failed: '+(err && err.message?err.message:String(err))); }
  }
  // replace the import handler if it exists with one that uses the new normalize function
  const importEl = document.getElementById('importFile');
  if(importEl){
    importEl.addEventListener('change', e=>{
      const f = e.target.files?.[0]; if(!f) return;
      const r = new FileReader(); r.onload = async ()=>{
        try{ const j = JSON.parse(r.result); if(Array.isArray(j)){ alert('Unsupported JSON format.'); } else { normalizeAndWriteImports(j); } }catch(err){ alert('Import failed: ' + err.message); }
      }; r.readAsText(f);
    });
  }

  /* ======================================================
     QUICK UI HELPERS: tiny functions referenced earlier but perhaps missing
     ====================================================== */
  // Q helper used in the 404 section earlier
  window.Q = window.Q || function(sel, ms=1500){ const el = document.getElementById('four_saved'); if(!el) return; el.style.display='inline'; setTimeout(()=>el.style.display='none', ms); };

  /* ======================================================
     STORE: Ensure Store.write uses backend safe-post semantics
     ====================================================== */
  // The HTML already defines a Store object earlier. If for some reason it's missing
  // here, create a minimal implementation that proxies to the API and stores in-memory.
  if(!window.Store){
    (function(){
      const _cache = { projects:[], blogs:[], profile:{}, about:{}, contact:{}, home:{} };
      window.Store = {
        read(key, fallback){ try{ const k = key.replace(/^cms_/, '').replace('cms_',''); return structuredClone(_cache[k] ?? JSON.parse(fallback || '{}')); }catch(e){ return JSON.parse(fallback||'{}'); } },
        async write(key, value){ try{ const k = key.replace(/^cms_/, '').replace('cms_',''); _cache[k] = value; // try to POST to backend
            try{ await apiPost(k, value); }catch(e){ console.warn('write: backend post failed', e); }
            return {ok:true}; }catch(e){ throw e; } },
        projects(){ return Array.isArray(_cache.projects)? _cache.projects.slice().sort((a,b)=> (b.updated||0)-(a.updated||0)) : []; },
        putProject(p){ if(!p.id) p.id = (crypto.randomUUID?crypto.randomUUID():String(Date.now())); p.updated = Date.now(); const arr = this.projects(); const i = arr.findIndex(x=>x.id===p.id); if(i>=0) arr[i]=p; else arr.unshift(p); _cache.projects = arr; this.write(LS_PROJECTS, arr); return p.id; },
        removeProject(id){ _cache.projects = this.projects().filter(x=>x.id!==id); this.write(LS_PROJECTS, _cache.projects); },
        byIdProject(id){ return this.projects().find(x=>x.id===id); },
        blogs(){ return Array.isArray(_cache.blogs)? _cache.blogs.slice().sort((a,b)=> (b.updated||0)-(a.updated||0)) : []; },
        putBlog(b){ if(!b.id) b.id = (crypto.randomUUID?crypto.randomUUID():String(Date.now())); b.updated = Date.now(); const arr = this.blogs(); const i = arr.findIndex(x=>x.id===b.id); if(i>=0) arr[i]=b; else arr.unshift(b); _cache.blogs = arr; this.write(LS_BLOGS, arr); return b.id; },
        removeBlog(id){ _cache.blogs = this.blogs().filter(x=>x.id!==id); this.write(LS_BLOGS, _cache.blogs); },
        byIdBlog(id){ return this.blogs().find(x=>x.id===id); },
        profile(){ return structuredClone(_cache.profile||{}); },
        saveProfile(p){ _cache.profile = p; this.write(LS_PROFILE, p); }
      };
    })();
  }

  /* ======================================================
     AUTH UI: open/close gate when session present
     ====================================================== */
  (function(){
    try{
      const authed = sessionStorage.getItem('bod_authed') === 'yes' || !!sessionStorage.getItem('bnd_token');
      const gateEl = document.getElementById('gate');
      if(authed && gateEl) gateEl.style.display='none';
    }catch(e){}
  })();

  /* ======================================================
     INITIAL PRIME: hydrate UI from Store (if global prime missing)
     ====================================================== */
  async function primeIfNeeded(){
    try{
      // If window.Store already talks to backend via prime() earlier, skip
      if(window._bnd_admin_primer) return;
      window._bnd_admin_primer = true;

      // Try to fetch server-side data for keys using API if available
      const API_BASE = (window.BNDLABS_API_BASE||'').replace(/\/+$/,'') + '/api/';
      const keys = ['home','projects','blogs','profile','about','contact','404'];
      for(const k of keys){
        try{
          const url = API_BASE + k;
          const r = await fetch(url, {credentials:'omit'});
          if(!r.ok) throw new Error('no');
          const json = await r.json().catch(()=>null);
          if(json!==null){
            // write into Store cache if Store supports write
            try{ await Store.write('cms_'+k, json); }catch(e){}
          }
        }catch(err){ /* ignore fetch errors */ }
      }

      // after hydration, render lists
      try{ renderProjects(); renderBlogs(); loadProfile(); }catch(e){}
    }catch(err){ console.warn('primeIfNeeded error', err); }
  }

  // run prime in background (non-blocking)
  setTimeout(()=>{ primeIfNeeded(); }, 200);

  /* ======================================================
     FINISH: ensure manual-save buttons that referenced remote features
     behave sensibly
     ====================================================== */
  // about_save already wired earlier to call Store.write; ensure it uses latest About.gather
  const aboutSaveBtn = document.getElementById('about_save');
  if(aboutSaveBtn){ aboutSaveBtn.addEventListener('click', async ()=>{ try{ const payload = About.gather(); await Store.write(LS_ABOUT, payload); flashSaved('about_ok'); alert('‚úÖ About data saved successfully!'); }catch(err){ alert('‚ö†Ô∏è Failed to save About: '+(err.message||err)); } }); }

  // Contact manual save button
  const saveContactBtn = document.getElementById('saveContactBtn');
  if(saveContactBtn){ saveContactBtn.addEventListener('click', async ()=>{ try{ const payload = Contact.gather(); await Store.write(LS_CONTACT, payload); flashSaved('contactSaved'); alert('‚úÖ Contact data saved!'); }catch(err){ alert('‚ö†Ô∏è Failed to save contact: '+(err.message||err)); } }); }

  // export buttons are good; ensure they include fresh reads from Store
  const aboutExport = document.getElementById('about_export');
  if(aboutExport){ aboutExport.addEventListener('click', ()=>{ try{ const data = About.gather(); const blob = new Blob([JSON.stringify(data,null,2)], {type:'application/json'}); const url = URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download='about.json'; a.click(); URL.revokeObjectURL(url); }catch(e){ alert('Export failed: '+e.message); } }); }

  const contactExport = document.getElementById('contact_export');
  if(contactExport){ contactExport.addEventListener('click', ()=>{ try{ const data = Contact.gather(); const blob = new Blob([JSON.stringify(data,null,2)], {type:'application/json'}); const url = URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download='contact.json'; a.click(); URL.revokeObjectURL(url); }catch(e){ alert('Export failed: '+e.message); } }); }

  // final console message
  console.info('Admin script: continuation loaded ‚Äî about/contact autosave and backend proxy ready.');

})();
